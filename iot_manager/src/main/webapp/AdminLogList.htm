<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <title>管理日志管理</title>

    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="css/plugins/select2/select2.css">
    <link rel="stylesheet" href="css/plugins/icheck/all.css">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/themes.css">
    <link rel="stylesheet" href="css/list.css">
    <link rel="stylesheet" href="css/plugins/datepicker/bootstrap-datetimepicker.css">
    <link rel="stylesheet" href="css/pagination.css">
    <!--[if IE 7]>
    <link rel="stylesheet" href="css/font-awesome-ie7.min.css">
    <link rel="stylesheet" href="css/ie7.css">

    <![endif]-->
    <script type="text/javascript" src="js/jquery.min.js"></script>
    <script type="text/javascript" src="js/bootstrap.min.js"></script>
    <script type="text/javascript" src="js/plugins/select2/select2.min.js"></script>
    <script type="text/javascript" src="js/plugins/icheck/jquery.icheck.min.js"></script>
    <script type="text/javascript" src="js/plugins/bootbox/jquery.bootbox.js"></script>
    <script type="text/javascript" src="js/plugins/datepicker/bootstrap-datetimepicker.js"></script>
    <script type="text/javascript" src="js/init.js"></script>
    <script type="text/javascript" src="js/plugins/jquery-paginator/jquery.pagination.js"></script>

    <!--[if lte IE 9]>
    <script src="js/plugins/placeholder/jquery.placeholder.min.js"></script>
    <script>
        $(document).ready(function () {
            $('input, textarea').placeholder();
        });
    </script>
    <![endif]-->
    <script type="text/javascript">
        $(document).ready(function () {
            $('#start_date').datetimepicker({autoclose: true, format: "yyyy-mm-dd", minView: 'month'});
            $('#end_date').datetimepicker({autoclose: true, format: "yyyy-mm-dd", minView: 'month'});
        });
    </script>
</head>
<body>
<div class="container-fluid" id="content">
    <div id="main">
        <div class="container-fluid">
            <div class="row-fluid">
                <div class="span12">
                    <div class="box box-bordered">
                        <div class="box-title">
                            <h3><i class="icon-table"></i> 管理日志列表</h3>
                        </div>
                        <div class="box-content nopadding">
                            <div class="dataTables_wrapper">
                                <div class="dataTables_info1" style="padding-top: 10px;">
                                    <div class="dataTables_filter form-inline">
                                        <!--<form class="form-inline" action="AdminLogList.htm" method="post">-->
                                        <div class="form-group pull-left" style="padding-right:5px;">
                                            开始时间
                                            <div class="input-group input-append" id="start_date_div" style="">
								<span class="input-group-addon add-on">
									<i class="fa fa-calendar icon-calendar" data-date-icon="icon-calendar"
                                       data-time-icon="icon-time"></i>
								</span>
                                                <input class="form-control input-sm" placeholder="开始时间"
                                                       style="width: 80px;" id="start_date" name="start_date"
                                                       value="" data-format="yyyy-MM-dd" type="text">
                                            </div>
                                        </div>
                                        <div class="form-group pull-left" style="padding-right:5px;">
                                            结束时间
                                            <div class="input-group input-append" id="end_date_div" style="">
									<span class="input-group-addon add-on">
										<i class="fa fa-calendar icon-calendar" data-date-icon="icon-calendar"
                                           data-time-icon="icon-time"></i>
									</span>
                                                <input class="form-control input-sm" placeholder="结束时间"
                                                       style="width: 80px;" id="end_date" name="end_date"
                                                       value="" style="width: 160px;" type="text">
                                            </div>
                                        </div>
                                        <label>类型: </label>
                                        <input type="text" class="input-small" name="optType" id="optType"
                                               placeholder="类型" value=""/>
                                        <label>账号: </label>
                                        <input type="text" class="input-small" name="account" id="account"
                                               placeholder="账号" value=""/>
                                        <label>详情: </label>
                                        <input type="text" class="input-medium" name="content" id="Text1"
                                               placeholder="详情" value=""/>
                                        <button id="logSearch" type="submit" class="btn btn-primary"><i
                                                class="icon-search"></i> 搜索
                                        </button>
                                        <!--</form>-->
                                    </div>
                                </div>
                                <div style="clear:both;"></div>
                                <table id = "systemLogItem" class="table table-hover table-nomargin table-bordered table-condensed">
                                    <thead>
                                    <tr>
                                        <th style="width:150px;">管理员</th>
                                        <th style="width:200px;">类型</th>
                                        <th>描述</th>
                                        <th>IP</th>
                                        <th style="width:150px;">时间</th>
                                    </tr>
                                    </thead>
                                    <!--<tbody>-->
                                    <!--<tr>-->
                                    <!--<td>admin</td>-->
                                    <!--<td>登陆</td>-->
                                    <!--<td>登陆系统</td>-->
                                    <!--<td>101.229.149.206</td>-->
                                    <!--<td>2019/2/16 8:49:32</td>-->
                                    <!--</tr>-->

                                    <!--</tbody>-->
                                </table>

                                <div id="pagination-container"></div>
                                <!--<div class="dataTables_paginate paging_full_numbers"> <a href="#" class="paginate_button paginate_button_disabled">首页</a>  <a href="#" class="paginate_button paginate_button_disabled">上一页</a>  <span>  <a href="AdminLogList.htm?pageIndex=1&start_date=2019-02-16&end_date=2019-02-16&optType=&content=&account=" class="paginate_active">1</a>   </span>  <a href="#" class="paginate_button paginate_button_disabled">下一页</a>  <a href="#" class="paginate_button paginate_button_disabled">尾页</a>  <a href="#" class="paginate_button paginate_button_disabled">共1条，1页</a>  <a href="#" class="paginate_button paginate_button_disabled">当前第</a>  <select name="pageSelect" id="pageSelect" class="select2-me input-mini"> <option value="AdminLogList.htm?pageIndex=1&start_date=2019-02-16&end_date=2019-02-16&optType=&content=&account=" selected="selected">1</option> </select> <a href="#" class="paginate_button paginate_button_disabled">页</a> </div>-->

                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
</body>

<script>


    $("#logSearch").click(function () {

        pageStart();//初始化

        function pageStart() {
            var account = $("#account").val();
            var startTime = $("#start_date").val();
            var endTime = $("#end_date").val();
            var optType = $("#optType").val();
            var Text1 = $("#Text1").val();
            $('#pagination-container').pagination({
                dataSource: '/api/v1/systemUser_all_log.do?startTime=' +
                    startTime + "&endTime=" + endTime + "&optType=" +
                    optType + "&Text1=" + Text1 + "&account=" + account,
                prevText: '<<',
                nextText: '>>',
                goButtonText: 'go',
                // className: 'paginationjs-theme-blue',
                alias: {
                    pageNumber: 'page',
                    pageSize: 'size'
                },
                pageSize: 10,
                totalNumberLocator: function (response) {//处理页数
                    return response.total;
                },
                locator: 'list',
                ajax: {
                    type: 'GET',
                    beforeSend: function () {//请求前处理
                        $("#dataContainer").html('加载中...');
                    }
                },
                showGoInput: true,
                showGoButton: true,
                showNavigator: true,
                callback: function (data, pagination) {
                    console.log(data);
                    $("#systemLogItem tr td").remove();//移除上一次查询的数据
                    $.each(data, function (i, item) {
                        var result = "<tr><td>" + item['account'] + "</td><td>" + item['operationType'] + "</td><td>" + item['operationIp'] + "</td><td>"
                            + item['instruction'] + "</td><td>" + item['operationTime'] + "</td></tr>";
                        $('#systemLogItem').append(result);
                    })
                }
            })
        }

    })

</script>
</html>
