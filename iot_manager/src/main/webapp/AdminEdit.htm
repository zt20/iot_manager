<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <title>修改管理员</title>

    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="css/plugins/datepicker/datepicker.css">
    <link rel="stylesheet" href="css/plugins/select2/select2.css">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/themes.css">
    <link rel="stylesheet" href="css/edit.css">
    <!--[if IE 7]>
    <link rel="stylesheet" href="css/font-awesome-ie7.min.css">
    <link rel="stylesheet" href="css/ie7.css">
    <![endif]-->
    <script type="text/javascript" src="js/jquery.min.js"></script>
    <script type="text/javascript" src="js/bootstrap.min.js"></script>
    <script type="text/javascript" src="js/plugins/form/jquery.form.min.js"></script>
    <script type="text/javascript" src="js/plugins/validation/jquery.validate.min.js"></script>
    <script type="text/javascript" src="js/plugins/validation/additional-methods.min.js"></script>
    <script type="text/javascript" src="js/plugins/datepicker/bootstrap-datepicker.js"></script>
    <script type="text/javascript" src="js/plugins/select2/select2.min.js"></script>
    <script type="text/javascript" src="js/plugins/bootbox/jquery.bootbox.js"></script>
    <script type="text/javascript" src="js/init.js"></script>
    <script type="text/javascript" src="js/md5.js"></script>
    <script type="text/javascript" src="js/loading.js"></script>

    <!--[if lte IE 9]>
    <script type="text/javascript" src="js/plugins/placeholder/jquery.placeholder.min.js"></script>
    <script>
        $(document).ready(function () {
            $("input, textarea").placeholder();
        });
    </script>
    <![endif]-->

    <!--<script>-->
    <!--$(document).ready(function () {-->
    <!--$("#formAdmin").ajaxForm({-->
    <!--success: function (result) {-->
    <!--bootbox.alert(result.Message);-->
    <!--},-->
    <!--error: function (XmlHttpRequest, textStatus, errorThrown) {-->
    <!--bootbox.alert("操作失败:服务器错误");-->
    <!--}-->
    <!--});-->
    <!--});-->
    <!--</script>-->

</head>
<body>
<div class="container-fluid" id="content">
    <div id="main">
        <div class="container-fluid">
            <div class="row-fluid">
                <div class="span12">
                    <div class="box box-bordered">
                        <div class="box-title">
                            <h3><i class="icon-edit"></i> 管理员</h3>
                        </div>
                        <div class="box-content">
                            <!--<form action="AdminEdit.htm?action=save&id=5" method="POST"-->
                                  <!--class="form-horizontal form-validate" id="formAdmin">-->
                            <div class="form-horizontal form-validate">
                                <div class="control-group">
                                    <label for="account" class="control-label">登录帐号：</label>
                                    <div class="controls">
                                        <b id="account" class="control-text"></b>
                                    </div>
                                </div>
                                <div class="control-group">
                                    <label for="realname" class="control-label">姓名：</label>
                                    <div class="controls">
                                        <input type="text" id="realname" name="realname" value="" class="input-xlarge"
                                               maxlength="20" data-msg-required="请填写姓名" title="最大允许输入20个字符"/>
                                    </div>
                                </div>
                                <div class="control-group">
                                    <label for="password" class="control-label">登录密码：</label>
                                    <div class="controls">
                                        <input type="password" id="password" name="password" maxlength="32"
                                               class="input-xlarge" data-rule-minlength="3"
                                               data-msg-minlength="登录密码至少为3位" title="登录密码必填，最大允许输入32个字符"/>
                                        <div class="help-block">如果不修改登录密码请保持为空</div>
                                    </div>
                                </div>
                                <div class="control-group">
                                    <label for="repassword" class="control-label">确认密码：</label>
                                    <div class="controls">
                                        <input type="password" id="repassword" name="repassword" maxlength="32"
                                               class="input-xlarge" data-rule-equalTo="#password"
                                               data-msg-equalTo="两次密码不匹配" title="确认密码必填，必须与登录密码一致"/>
                                    </div>
                                </div>

                                <!--<div class="control-group">-->
                                <!--<label for="FinanceRight" class="control-label">权限：</label>-->
                                <!--<div class="controls">-->
                                <!--全部<input type="radio" name="FinanceRight" value="2" checked="checked" />-->
                                <!--Ⅰ类<input type="radio" name="FinanceRight" value="0"  />-->
                                <!--Ⅱ类<input type="radio" name="FinanceRight" value="1"  />-->
                                <!--</div>-->
                                <!--</div>-->
                                <div class="control-group">
                                    <label for="mobile" class="control-label">手机号码：</label>
                                    <div class="controls">
                                        <input type="text" id="mobile" name="mobile" value="13648385265"
                                               class="input-xlarge" maxlength="11" data-rule-mobile="true"
                                               data-msg-mobile="手机号码格式不正确" placeholder=" 例：13900000000"
                                               title="手机号码最大允许输入11个字符 "/>
                                    </div>
                                </div>
                                <div class="control-group">
                                    <label for="email" class="control-label">电子邮件：</label>
                                    <div class="controls">
                                        <input type="text" id="email" name="email" class="input-xlarge" maxlength="50"
                                               data-rule-email="true" data-msg-email="电子邮箱格式不正确"
                                               placeholder=" 例：88888888@qq.com" title="电子邮件最大允许输入50个字符 "/>
                                    </div>
                                </div>
                                <!--<div class="control-group">-->
                                <!--<label for="email" class="control-label">登陆IP：</label>-->
                                <!--<div class="controls">-->
                                <!--<textarea name="allowIps" id="allowIps" rows="5" cols="10" placeholder="为空不限制登陆IP，一行一个，支持IP段，后面用*替代，例 202.203.1.*" ></textarea>-->
                                <!--</div>-->
                                <!--</div>-->
                                <div class="control-group">
                                    <label for="state" class="control-label">状态:</label>
                                    <div class="controls">
                                        <select id="state" name="state" class="select-xlarge"
                                                data-search="false">
                                            <option value="0">正常</option>
                                            <option value="1">锁定</option>
                                        </select>

                                    </div>
                                </div>
                                <div class="form-actions">
                                    <button type="submit" class="btn btn-primary" id="btnSubmit"><i
                                            class="icon-ok-sign"></i> 修改管理员
                                    </button>
                                </div>
                            </div>
                            <!--</form>-->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
</body>

<script>

    $(document).ready(function () {
        var account = location.search;
        account = account.substr(1);
        console.log(account);
        $.ajax({
            type: "GET",
            url: "/api/v1/systemUser_account.do?account=" + account,
            success: function (data) {
                // alert(data)
                if (data.code == 0) {
                    var systemUser = data.object;
                    if (null == systemUser) {
                        alert("该用户已经不存在");
                    }
                    console.log(systemUser);
                    $("#account").html(systemUser.account);
                    $("#realname").val(systemUser.name);
                    $("#mobile").val(systemUser.mobile);
                    $("#email").val(systemUser.email);
                    $("#state").val(systemUser.status);
                    // $("#state").attr(status(systemUser.status), systemUser.status);
                    // $("#password").val(systemUser.password);
                } else {
                    alert("查询失败");
                    window.location.href = '/Login.htm';
                }
            }
        });
    })

    $("#btnSubmit").click(function () {
        console.log("click");
        var mobile = $("#mobile").val();
        var email = $("#email").val();
        var name = $("#realname").val();
        var password = hex_md5($("#password").val());
        var status = $("#state").val();
        var account = $("#account").html();
        if (confirm("确定修改么？")) {
            $.ajax({
                type: "POST",
                url: "/api/v1/systemUser_update.do",
                data: {
                    mobile: mobile,
                    email: email,
                    name: name,
                    password: password,
                    status:status,
                    account:account
                },
                success: function (data) {
                    if (data.code == 0){
                        alert("修改成功!");
                        window.location.href="/AdminList.htm";
                    }else {
                        alert(data.msg);
                    }
                }
            });
        }
    });

</script>

</html>

