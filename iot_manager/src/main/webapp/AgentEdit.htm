<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <title>修改代理商</title>

    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="css/plugins/select2/select2.css">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/themes.css">
    <link rel="stylesheet" href="css/edit.css">
    <style type="text/css">
        .additional {
            display: none;
        }

        .bannerOemAdditional {
            display: none;
        }
    </style>
    <!--[if IE 7]>
    <link rel="stylesheet" href="css/font-awesome-ie7.min.css">
    <link rel="stylesheet" href="css/ie7.css">
    <![endif]-->
    <script type="text/javascript" src="js/jquery.min.js"></script>
    <script type="text/javascript" src="js/bootstrap.min.js"></script>
    <script type="text/javascript" src="js/plugins/form/jquery.form.min.js"></script>
    <script type="text/javascript" src="js/plugins/validation/jquery.validate.min.js"></script>
    <script type="text/javascript" src="js/plugins/validation/additional-methods.min.js"></script>
    <script type="text/javascript" src="js/plugins/select2/select2.min.js"></script>
    <script type="text/javascript" src="js/plugins/bootbox/jquery.bootbox.js"></script>
    <script type="text/javascript" src="js/md5.js"></script>

    <script type="text/javascript" src="js/plugins/fileupload/bootstrap-fileupload.min.js"></script>
    <script type="text/javascript" src="ckeditor/ckeditor.js"></script>

    <script type="text/javascript" src="js/init.js"></script>
    <script type="text/javascript" src="js/loading.js"></script>

    <!--[if lte IE 9]>
    <script type="text/javascript" src="js/plugins/placeholder/jquery.placeholder.min.js"></script>
    <script>
        $(document).ready(function () {
            $("input, textarea").placeholder();
        });
    </script>
    <![endif]-->

    <script>
        // $(document).ready(function () {
        // 	$("#agentType").on("click", function () {
        // 		if ($("#agentType").is(':checked')) {
        // 			$(".additional").show();
        // 		} else {
        // 			$(".additional").hide();
        // 		}
        // 	});
        //
        //
        //     $(".M2MBillingModel").on("click", function () {
        //         if ($(this).val() == 0) {
        //             $(".M2MBillingModel_0").show();
        //         } else {
        //             $(".M2MBillingModel_0").hide();
        //         }
        //     });
        //
        //
        // 	$(".bannerOemRadio").on("click", function () {
        // 		if ($("input[name='bannerOem']:checked").val() == "2") {
        // 			$(".bannerOemAdditional").show();
        // 		} else {
        // 			$(".bannerOemAdditional").hide();
        // 		}
        // 	});
        //
        // 	$("#btnSubmit").click(function () {
        // 		$("#mobilePageRemark").val(CKEDITOR.instances.mobilePageRemark.getData());
        // 	});
        //
        //     $("#formAgent").ajaxForm({
        //         success: function (result) {
        //             bootbox.alert(result.Message);
        //         },
        //         error: function (XmlHttpRequest, textStatus, errorThrown) {
        //             bootbox.alert("操作失败:服务器错误");
        //         }
        //     });
        //
        //
        // 	$("#img-uplaod-form").ajaxForm({
        //         success: function (result) {
        //            if(result.Message!=""){
        // 				if($("#action").val()=="save"){
        // 					$("#agentSysLogo").val(result.Message);
        // 					$("#agentSysLogoShow").attr("src","http://47.92.159.122:8083"+result.Message+"?"+Math.random());
        // 				}else if($("#action").val()=="saveDefault"){
        // 					$("#mobilePageBanner").val(result.Message);
        // 					$("#mobilePageBannerShow").attr("src", "http://47.92.159.122:8083" + result.Message+"?"+Math.random());
        // 				}else if($("#action").val()=="agentLoginImgTop"){
        // 					$("#agentLoginImgTop").val(result.Message);
        // 					$("#agentLoginImgTopShow").attr("src", "http://47.92.159.122:8083" + result.Message+"?"+Math.random());
        // 				}else if($("#action").val()=="agentLoginImgMid"){
        // 					$("#agentLoginImgMid").val(result.Message);
        // 					$("#agentLoginImgMidShow").attr("src", "http://47.92.159.122:8083" + result.Message+"?"+Math.random());
        // 				}
        // 				$("#img-uplaod").modal("hide");
        // 		   }else{
        // 				bootbox.alert("上传失败！");
        // 		   };
        //         },
        //         error: function (XmlHttpRequest, textStatus, errorThrown) {
        //             bootbox.alert("操作失败:服务器错误!");
        //         }
        //     });
        //
        //
        // });
        // function imgUpload(){
        // 	$("#action").val("save");
        // 	$("#img-uplaod").modal();
        // }
        // function bannerimgUpload(){
        // 	$("#action").val("saveDefault");
        // 	$("#img-uplaod").modal();
        // }
        //
        // function AgentLoginImgTopUpload(){
        // 	$("#action").val("agentLoginImgTop");
        // 	$("#img-uplaod").modal();
        // }
        //
        // function AgentLoginImgMidUpload(){
        // 	$("#action").val("agentLoginImgMid");
        // 	$("#img-uplaod").modal();
        // }
    </script>

</head>
<body>
<div class="container-fluid" id="content">
    <div id="main">
        <div class="container-fluid">
            <div class="row-fluid">
                <div class="span12">
                    <div class="box box-bordered">
                        <div class="box-title">
                            <h3><i class="icon-edit"></i>代理商</h3>
                        </div>
                        <div class="box-content">
                            <div class="form-horizontal form-validate" id="formAgent">
                                <div class="control-group">
                                    <label for="account" class="control-label">登录帐号：</label>
                                    <div class="controls">
                                        <b id="account" class="control-text"></b>
                                    </div>
                                </div>
                                <div class="control-group">
                                    <label for="password" class="control-label">登录密码：</label>
                                    <div class="controls">
                                        <input type="password" id="password" name="password" maxlength="32"
                                               class="input-xlarge" data-rule-minlength="3"
                                               data-msg-minlength="登录密码至少为3位" title="登录密码最大允许输入32个字符"/>
                                        <div class="help-block">如果不修改密码请保持为空</div>
                                    </div>
                                </div>
                                <div class="control-group">
                                    <label for="repassword" class="control-label">确认密码：</label>
                                    <div class="controls">
                                        <input type="password" id="repassword" name="repassword" maxlength="32"
                                               class="input-xlarge" data-rule-equalto="#password"
                                               data-msg-equalto="两次密码不匹配" title="确认密码必须与登录密码一致"/>
                                    </div>
                                </div>
                                <div class="control-group">
                                    <label for="agentName" class="control-label">代理名称：</label>
                                    <div class="controls">
                                        <input type="text" id="agentName" name="agentName" class="input-xlarge"
                                               maxlength="20" data-rule-required="true" data-msg-required="请填写代理名称"
                                               data-rule-minlength="3" data-msg-minlength="代理名称至少3位"
                                               title="代理名称必填，最大允许输入20个字符"/>
                                    </div>
                                </div>
                                <!--<div class="control-group">-->
                                <!--<label for="nickName" class="control-label">昵称：</label>-->
                                <!--<div class="controls">-->
                                <!--<input type="text" id="nickName" name="nickName" class="input-xlarge" value="客服经理"/>-->
                                <!--</div>-->
                                <!--</div>-->
                                <div class="control-group">
                                    <label for="mobile" class="control-label">手机号码：</label>
                                    <div class="controls">
                                        <input type="text" id="mobile" name="mobile" value="" class="input-xlarge"
                                               maxlength="11" data-rule-mobile="true" data-msg-mobile="手机号码格式不正确"
                                               placeholder=" 例：13900000000" title="手机号码最大允许输入11个字符 "/>
                                    </div>
                                </div>
                                <div class="control-group">
                                    <label for="email" class="control-label">电子邮件：</label>
                                    <div class="controls">
                                        <input type="text" id="email" name="email" value="" class="input-xlarge"
                                               maxlength="50" data-rule-email="true" data-msg-email="电子邮箱格式不正确"
                                               placeholder=" 例：88888888@qq.com" title="电子邮件最大允许输入50个字符 "/>
                                    </div>
                                </div>
                                <div class="control-group">
                                    <label for="address" class="control-label">联系地址：</label>
                                    <div class="controls">
                                        <textarea id="address" name="address" rows="5"
                                                  class="input-block-level"></textarea>
                                    </div>
                                </div>
                                <div class="control-group">
                                    <label for="telephone1" class="control-label">服务热线：</label>
                                    <div class="controls">
                                        <input type="text" id="telephone1" name="telephone1" class="input-xlarge"/>
                                    </div>
                                </div>
                                <div class="control-group">
                                    <label for="telephone2" class="control-label">售前热线：</label>
                                    <div class="controls">
                                        <input type="text" id="telephone2" name="telephone2" class="input-xlarge"/>
                                    </div>
                                </div>

                                <div class="control-group">
                                    <label for="M2MBillingModel" class="control-label">物联网计费模式：</label>
                                    <div class="controls">
                                        <input type="radio" name="M2MBillingModel" value="0" checked="checked"
                                               class="bannerOemRadio input-xlarge M2MBillingModel"/> 返佣
                                        <input type="radio" name="M2MBillingModel" value="1"
                                               class="bannerOemRadio input-xlarge M2MBillingModel"/> 预存
                                    </div>
                                </div>
                                <div class="control-group M2MBillingModel_0">
                                    <label for="M2MRebateMode" class="control-label">物联网返佣模式：</label>
                                    <div class="controls">
                                        <input type="radio" name="M2MRebateMode" value="0" checked="checked"
                                               class="bannerOemRadio input-xlarge"/> 按比例
                                        <input type="radio" name="M2MRebateMode" value="1"
                                               class="bannerOemRadio input-xlarge"/> 固定金额
                                    </div>
                                </div>
                                <div class="control-group M2MBillingModel_0">
                                    <label for="M2MRebateValue" class="control-label">返佣值：</label>
                                    <div class="controls">
                                        <input type="text" id="M2MRebateValue" name="M2MRebateValue" value="0.0000"
                                               class="input-small"/>按比例时，需小于1
                                    </div>
                                </div>


                                <!--<div class="control-group" style="border-top:1px solid #ddd;">-->
                                <!--<label for="EditUserIP" class="control-label">修改客户IP：</label>-->
                                <!--<div class="controls">-->
                                <!--<input type="radio" name="EditUserIP" value="1" checked="checked" class="bannerOemRadio input-xlarge"/> 允许-->
                                <!--<input type="radio" name="EditUserIP" value="0"  class="bannerOemRadio input-xlarge"/> 不允许-->
                                <!--<br />-->
                                <!--<span style="color:Red;">不允许修改的客户IP的情况下，代理将不能设置客户的IP限制。</span>-->
                                <!--</div>-->
                                <!--</div>-->
                                <!---->
                                <!--<div class="control-group">-->
                                <!--<label for="email" class="control-label">登陆IP：</label>-->
                                <!--<div class="controls">-->
                                <!--<textarea name="allowIps" id="allowIps" rows="5" cols="10" placeholder="为空不限制登陆IP，一行一个，支持IP段，后面用*替代，例 202.203.1.*" ></textarea>-->
                                <!--</div>-->
                                <!--</div>-->
                                <!--<div class="control-group">-->
                                <!--<label for="email" class="control-label">限制跳转IP：</label>-->
                                <!--<div class="controls">-->
                                <!--<textarea name="turnIp" id="turnIp" rows="5" cols="10" placeholder="为空不限制跳转IP，一行一个，支持IP段，后面用*替代，例 202.203.1.*" ></textarea>-->
                                <!--</div>-->
                                <!--</div>-->

                                <div class="control-group">
                                    <label for="status" class="control-label">状态：</label>
                                    <div class="controls">
                                        <select id="status" name="status" class="select-xlarge" data-search="false">
                                            <option value="0">启用</option>
                                            <option value="1">停用</option>
                                        </select>
                                    </div>
                                </div>

                                <!--<div class="control-group">-->
                                <!--<label for="agentType" class="control-label">启用自有域名：</label>-->
                                <!--<div class="controls">-->
                                <!--<input type="checkbox" value="1" id="agentType" name="agentType"  class="input-xlarge" />-->
                                <!--特殊代理才启用并修改下列配置，需要先绑定域名和增加logo和登录页面-->
                                <!--</div>-->
                                <!--</div>-->

                                <!--<div class="control-group additional">-->
                                <!--<label for="agentSysName" class="control-label">系统显示名称：</label>-->
                                <!--<div class="controls">-->
                                <!--<input type="text" value="流量平台" id="agentSysName" name="agentSysName" class="input-xlarge" maxlength="20" data-rule-required="true" data-msg-required="请填写系统显示名称" data-rule-minlength="1" data-msg-minlength="系统显示名称至少1位" title="系统显示名称必填，最大允许输入20个字符" />-->
                                <!--</div>-->
                                <!--</div>-->

                                <!--<div class="control-group additional">-->
                                <!--<label for="agentSysLogo" class="control-label">系统LOGO：</label>-->
                                <!--<div class="controls">-->
                                <!--<input type="text" value="/imgs/login/logo.png" id="agentSysLogo" name="agentSysLogo" class="input-xlarge" maxlength="200" data-rule-required="true" data-msg-required="请填写系统图标" data-rule-minlength="3" data-msg-minlength="系统图标至少3位" title="系统图标必填，最大允许输入200个字符" /> <input type="button" onclick="imgUpload()" value="上传" /> <img width="125" height="50" alt="logo" id="agentSysLogoShow" src="http://47.92.159.122:8083/imgs/login/logo.png" />-->
                                <!--</div>-->
                                <!--</div>-->

                                <!--<div class="control-group additional">-->
                                <!--<label for="agentLoginImgTop" class="control-label">顶部图片：</label>-->
                                <!--<div class="controls">-->
                                <!--<input type="text" value="/imgs/slogan.png" id="agentLoginImgTop" name="agentLoginImgTop" class="input-xlarge" maxlength="200" data-rule-required="true" data-msg-required="请填写系统图标" data-rule-minlength="3" data-msg-minlength="系统图标至少3位" title="系统图标必填，最大允许输入200个字符" /> <input type="button" onclick="AgentLoginImgTopUpload()" value="上传" /> <img width="248" height="26" alt="logo" id="agentLoginImgTopShow" src="http://47.92.159.122:8083/imgs/slogan.png" />-->
                                <!--</div>-->
                                <!--</div>-->

                                <!--<div class="control-group additional">-->
                                <!--<label for="agentLoginImgMid" class="control-label">中部图片：</label>-->
                                <!--<div class="controls">-->
                                <!--<input type="text" value="/upload/1_Mid.jpg" id="agentLoginImgMid" name="agentLoginImgMid" class="input-xlarge" maxlength="200" data-rule-required="true" data-msg-required="请填写系统图标" data-rule-minlength="3" data-msg-minlength="系统图标至少3位" title="系统图标必填，最大允许输入200个字符" /> <input type="button" onclick="AgentLoginImgMidUpload()" value="上传" /> <img width="200" height="131" alt="logo" id="agentLoginImgMidShow" src="http://47.92.159.122:8083/upload/1_Mid.jpg" />-->
                                <!--</div>-->
                                <!--</div>-->

                                <!--<div class="control-group additional">-->
                                <!--<label for="agentDomain" class="control-label">绑定域名：</label>-->
                                <!--<div class="controls">-->
                                <!--<input type="text" value="http://47.92.159.122:8085" id="agentDomain" name="agentDomain" class="input-xlarge" maxlength="200" data-rule-required="true" data-msg-required="请填写域名" data-rule-minlength="3" data-msg-minlength="域名至少3位" title="域名必填，最大允许输入200个字符" />-->
                                <!--</div>-->
                                <!--</div>-->

                                <!--<div class="control-group additional">-->
                                <!--<label for="agentLogin" class="control-label">登陆页面：</label>-->
                                <!--<div class="controls">-->
                                <!--<input type="text" value="/login.htm" id="agentLogin" name="agentLogin" class="input-xlarge" maxlength="200" data-rule-required="true" data-msg-required="请填写域名" data-rule-minlength="3" data-msg-minlength="域名至少3位" title="域名必填，最大允许输入200个字符" />-->
                                <!--</div>-->
                                <!--</div>-->
                                <!--<div class="control-group additional">-->
                                <!--<label for="agentRegist" class="control-label">注册地址：</label>-->
                                <!--<div class="controls">-->
                                <!--<input type="text" value="/regist.htm" id="agentRegist" name="agentRegist" class="input-xlarge" maxlength="200" title="域名必填，最大允许输入200个字符"/>-->
                                <!--</div>-->
                                <!--</div>-->
                                <!--<div class="control-group additional">-->
                                <!--<label for="agentICP" class="control-label">ICP：</label>-->
                                <!--<div class="controls">-->
                                <!--<input type="text" value="" id="agentICP" name="agentICP" class="input-xlarge" maxlength="200" title="域名必填，最大允许输入200个字符"/>-->
                                <!--</div>-->
                                <!--</div>-->

                                <div class="control-group">
                                    <label for="company" class="control-label">企业名称：</label>
                                    <div class="controls">
                                        <input type="text" value="" id="company" name="company" class="input-xlarge"
                                               maxlength="50" title="企业名称"/>
                                    </div>
                                </div>

                                <div class="control-group">
                                    <label for="bankName" class="control-label">开户银行：</label>
                                    <div class="controls">
                                        <input type="text" value="" id="bankName" name="bankName" class="input-xlarge"
                                               value="" maxlength="25" title="开户银行必填，最大允许输入25个字符"/>
                                    </div>
                                </div>
                                <div class="control-group">
                                    <label for="bankUserName" class="control-label">开户名称：</label>
                                    <div class="controls">
                                        <input type="text" value="" id="bankUserName" name="bankUserName"
                                               class="input-xlarge" value="" maxlength="25" title="开户名称必填，最大允许输入25个字符"/>
                                    </div>
                                </div>

                                <div class="control-group">
                                    <label for="bankAccount" class="control-label">银行账号：</label>
                                    <div class="controls">
                                        <input type="text" value="" id="bankAccount" name="bankAccount"
                                               class="input-xlarge" value="" maxlength="25" title="账号必填，最大允许输入25个字符"/>
                                    </div>
                                </div>

                                <div class="form-actions">
                                    <button type="submit" class="btn btn-primary" id="btnSubmit"><i
                                            class="icon-ok-sign"></i>修改代理商
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!--<div id="img-uplaod" class="modal hide fade" role="dialog" aria-labelledby="img-uplaod-form" aria-hidden="true">-->
<!--<form action="ImageUpload.htm" id="img-uplaod-form" class="form-vertical form-validate">-->
<!--<div class="modal-body">-->
<!--<div class="box-content">-->
<!--<input type="file" name="imageUrl"/>-->
<!--<input type="hidden" id="action" name="action" value="save" />-->
<!--<input type="hidden" name="id" value="1" />-->
<!--</div>-->
<!--<div class="modal-footer">-->
<!--<a class="btn" data-dismiss="modal" aria-hidden="true">关闭</a> -->
<!--<button type="submit" class="btn btn-primary" id="Button1">提交</button>-->
<!--</div>-->
<!--</div>-->
<!--</form>-->
<!--</div>-->

</body>

<script>
    $(document).ready(function () {
        var id = location.search;
        id = id.substr(1);
        $.ajax({
            type: "GET",
            url: "/api/v1/agent_id.do?id=" + id,
            success: function (data) {
                // alert(data)
                if (data.code == 0) {
                    var agent = data.object;
                    if (null == agent) {
                        alert("该代理商已经不存在");
                    }
                    console.log(agent);
                    $("#account").html(agent.agentAccount);
                    $("#agentName").val(agent.name);
                    $("#mobile").val(agent.mobile);
                    $("#email").val(agent.email);
                    $("#address").val(agent.address);
                    $("#telephone1").val(agent.serviceHotLine);
                    $("#telephone2").val(agent.preSaleHotLine);
                    $("#company").val(agent.companyName);
                    $("#bankName").val(agent.bankName);
                    $("#bankUserName").val(agent.bankUserName);
                    $("#bankAccount").val(agent.bankAccount);
                    $("#status").val(agent.status);
                    $("input[name='M2MBillingModel'][value= " + agent.billingMode + " ]").attr("checked", true);
                    $("input[name='M2MRebateMode'][value= " + agent.rebateMode + " ]").attr("checked", true);
                    $("#M2MRebateValue").val(agent.rebateValue);
                    // $("#state").attr(status(systemUser.status), systemUser.status);
                    // $("#password").val(systemUser.password);
                } else {
                    alert("查询失败");
                }
            },
            error: function (XMLHttpRequest) {
                alert("系统出错了" + XMLHttpRequest.status);
            },
        });
    });

    $("#btnSubmit").click(function () {
        var id = location.search;
        id = id.substr(1);
        var password = hex_md5($("#password").val());
        var rePassword = hex_md5($("#repassword").val());
        if (password != rePassword) {
            alert("两次密码不一致");
            return;
        }
        var name = $("#agentName").val();
        var mobile = $("#mobile").val();
        var email = $("#email").val();
        var address = $("#address").val();
        var serviceHotLine = $("#telephone1").val();
        var preSaleHotLine = $("#telephone2").val();
        var billingMode = $(":radio[name='M2MBillingModel']:checked").val();
        var rebateMode = $(":radio[name='M2MRebateMode']:checked").val();
        var rebateValue = $("#M2MRebateValue").val();
        var companyName = $("#company").val();
        var bankName = $("#bankName").val();
        var bankUserName = $("#bankUserName").val();
        var bankAccount = $("#bankAccount").val();
        var status = $("#status").val();


        if (confirm("确定修改么？")) {
            $.ajax({
                type: 'POST',
                url: '/api/v1/agent_update.do',
                data: {
                    id: id,
                    name: name,
                    password: password,
                    mobile: mobile,
                    email: email,
                    address: address,
                    serviceHotLine: serviceHotLine,
                    preSaleHotLine: preSaleHotLine,
                    billingMode: billingMode,
                    rebateValue: rebateValue,
                    rebateMode: rebateMode,
                    companyName: companyName,
                    bankName: bankName,
                    bankUserName: bankUserName,
                    bankAccount: bankAccount,
                    status: status,
                },
                success: function (data) {
                    console.log(data);
                    if (data.code == 0) {
                        alert("修改成功!");
                        window.location.href = '/AgentList.htm';
                    } else {
                        alert(data.msg);
                    }

                },
                error: function (XMLHttpRequest) {
                    alert("系统出错了" + XMLHttpRequest.status);
                },
            });

        }

    });


</script>


</html>

